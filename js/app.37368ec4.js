(function(a){function t(t){for(var s,n,r=t[0],d=t[1],u=t[2],i=0,o=[];i<r.length;i++)n=r[i],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&o.push(l[n][0]),l[n]=0;for(s in d)Object.prototype.hasOwnProperty.call(d,s)&&(a[s]=d[s]);c&&c(t);while(o.length)o.shift()();return p.push.apply(p,u||[]),e()}function e(){for(var a,t=0;t<p.length;t++){for(var e=p[t],s=!0,n=1;n<e.length;n++){var r=e[n];0!==l[r]&&(s=!1)}s&&(p.splice(t--,1),a=d(d.s=e[0]))}return a}var s={},n={app:0},l={app:0},p=[];function r(a){return d.p+"js/"+({}[a]||a)+"."+{"chunk-76d63715":"cbc9469a"}[a]+".js"}function d(t){if(s[t])return s[t].exports;var e=s[t]={i:t,l:!1,exports:{}};return a[t].call(e.exports,e,e.exports,d),e.l=!0,e.exports}d.e=function(a){var t=[],e={"chunk-76d63715":1};n[a]?t.push(n[a]):0!==n[a]&&e[a]&&t.push(n[a]=new Promise((function(t,e){for(var s="css/"+({}[a]||a)+"."+{"chunk-76d63715":"c07999e2"}[a]+".css",l=d.p+s,p=document.getElementsByTagName("link"),r=0;r<p.length;r++){var u=p[r],i=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(i===s||i===l))return t()}var o=document.getElementsByTagName("style");for(r=0;r<o.length;r++){u=o[r],i=u.getAttribute("data-href");if(i===s||i===l)return t()}var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.onload=t,c.onerror=function(t){var s=t&&t.target&&t.target.src||l,p=new Error("Loading CSS chunk "+a+" failed.\n("+s+")");p.code="CSS_CHUNK_LOAD_FAILED",p.request=s,delete n[a],c.parentNode.removeChild(c),e(p)},c.href=l;var g=document.getElementsByTagName("head")[0];g.appendChild(c)})).then((function(){n[a]=0})));var s=l[a];if(0!==s)if(s)t.push(s[2]);else{var p=new Promise((function(t,e){s=l[a]=[t,e]}));t.push(s[2]=p);var u,i=document.createElement("script");i.charset="utf-8",i.timeout=120,d.nc&&i.setAttribute("nonce",d.nc),i.src=r(a);var o=new Error;u=function(t){i.onerror=i.onload=null,clearTimeout(c);var e=l[a];if(0!==e){if(e){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;o.message="Loading chunk "+a+" failed.\n("+s+": "+n+")",o.name="ChunkLoadError",o.type=s,o.request=n,e[1](o)}l[a]=void 0}};var c=setTimeout((function(){u({type:"timeout",target:i})}),12e4);i.onerror=i.onload=u,document.head.appendChild(i)}return Promise.all(t)},d.m=a,d.c=s,d.d=function(a,t,e){d.o(a,t)||Object.defineProperty(a,t,{enumerable:!0,get:e})},d.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},d.t=function(a,t){if(1&t&&(a=d(a)),8&t)return a;if(4&t&&"object"===typeof a&&a&&a.__esModule)return a;var e=Object.create(null);if(d.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:a}),2&t&&"string"!=typeof a)for(var s in a)d.d(e,s,function(t){return a[t]}.bind(null,s));return e},d.n=function(a){var t=a&&a.__esModule?function(){return a["default"]}:function(){return a};return d.d(t,"a",t),t},d.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)},d.p="",d.oe=function(a){throw console.error(a),a};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var o=0;o<u.length;o++)t(u[o]);var c=i;p.push([0,"chunk-vendors"]),e()})({0:function(a,t,e){a.exports=e("56d7")},"034f":function(a,t,e){"use strict";e("85ec")},"0494":function(a,t,e){"use strict";e("f452")},"0efe":function(a,t,e){},"1ba1":function(a,t,e){"use strict";e("49c5")},3039:function(a,t,e){},3097:function(a,t,e){},3508:function(a,t,e){"use strict";e("cd53")},"3fdb":function(a,t,e){a.exports=e.p+"img/b13f3bbcbf909e419ea15ac0d99e56e2.35c00faa.jpg"},4678:function(a,t,e){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(a){var t=l(a);return e(t)}function l(a){if(!e.o(s,a)){var t=new Error("Cannot find module '"+a+"'");throw t.code="MODULE_NOT_FOUND",t}return s[a]}n.keys=function(){return Object.keys(s)},n.resolve=l,a.exports=n,n.id="4678"},"49c5":function(a,t,e){},"4fd3":function(a){a.exports=JSON.parse('{"navigationList":[{"title":"搜索引擎","list":[{"img":"https://inews.gtimg.com/newsapp_bt/0/14052595932/1000","text":"google","link":"http://www.google.com"},{"img":"https://d-image.i4.cn/image/icon/2022/07/11/12/382201985/z1657512961934_650957.jpg","text":"百度一下","link":"http://www.baidu.com"}]},{"title":"数据转化工具","list":[{"img":"https://5b0988e595225.cdn.sohucs.com/q_70,c_zoom,w_640/images/20180806/5683f84ed9174c5da72d7822881862d0.jpeg","text":"json转化","link":"https://www.json.cn/"},{"img":"https://bpic.51yuansu.com/pic2/cover/00/38/76/5812c09d9e095_610.jpg?x-oss-process=image/sharpen,100","text":"时间单位转化","link":"https://cn.office-converter.com/Milliseconds-Time-Converter"},{"img":"https://img.tukuppt.com/png_preview/00/31/67/ZBPY7HkIDB.jpg!/fw/780","text":"时间戳转化","link":"https://tool.lu/timestamp/"}]},{"title":"翻译","list":[{"img":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fgss0.baidu.com%2F94o3dSag_xI4khGko9WTAnF6hhy%2Fzhidao%2Fwh%3D800%2C450%3B%2Fsign%3Dd3392fe103b30f2435cfe40bf8a5fd77%2F5243fbf2b211931318ce7b3069380cd790238da5.jpg&refer=http%3A%2F%2Fgss0.baidu.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1662432461&t=3b42e59de7b9c3a429ccfde532e0c9c1","text":"百度翻译","link":"https://fanyi.baidu.com/?aldtype=16047"},{"img":"https://hao.gjw123.com/zb_users/upload/printer/2021-07-10/60e8a6189787e.jpg","text":"谷歌翻译","link":"https://translate.google.cn/"},{"img":"https://exp-picture.cdn.bcebos.com/1570c1b6326c5766f95b57e6a4632385e1366129.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80","text":"有道翻译","link":"https://fanyi.youdao.com/"}]}],"tagList":[{"name":"Sentinel","documentIdList":["15e1b23d-40d6-46aa-a42b-07458602ec82"]},{"name":"流量监控","documentIdList":["15e1b23d-40d6-46aa-a42b-07458602ec82"]}],"documentList":[{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵1","img":"https://p3.qhimg.com/bdr/__85/t01a2c69f5b7eeac889.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵2","img":"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵3","img":"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵4","img":"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵5","img":"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵6","img":"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵7","img":"https://p8.qhimg.com/bdr/__85/t0186bdfba93c114775.jpg","status":true,"label":"推荐","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵8","img":"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵9","img":"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵10","img":"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵11","img":"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵12","img":"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵12","img":"https://p8.qhimg.com/bdr/__85/t01941321a72d8d5bd3.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"},{"id":"d9ede6fe-1230-43fb-a3e2-d54eb3d06557","title":"Sentinel-流量防卫兵13","img":"https://p8.qhimg.com/bdr/__85/t013759cbbb72642670.jpg","status":true,"label":"","tagList":["Sentinel","流量防卫兵"],"tag":"","abstract":"很多时候默认的分词效果达不到线上使用的要求，这就需要不断维护扩展词典和停止词字典，提高分词匹配的准确性，优化用户体验。\\n在IK分词器中，主要可以维护2种词典，一种是扩展词典，可以自定义一些词语，提高分词精读。\\n另一种是停止词词典，停止词就是指不会被分词拆分出来的词语，不参与分词和检索操作。\\n可以通过修改IKAnalyzer.cfg.xml配置文件，来自定义词典。IKAnalyzer.cfg.xml的位置为{plugins}/ik/config/。","action":{"read":2281,"like":1967,"comment":0},"datetime":1659352458594,"catalogue":[{"type":"header1","children":[{"text":"1.背景"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-3"},{"type":"header2","children":[{"text":"1.1 简介"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-21"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 具有以下特征"}],"id":"w-e-element-93"},{"type":"header3","textAlign":"start","children":[{"text":"Sentinel 的主要特性"}],"id":"w-e-element-89"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.2 学习参考"}],"id":"w-e-element-97"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"1.3 章节介绍"}],"id":"w-e-element-101"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.项目构建"}],"id":"w-e-element-105"},{"type":"header2","children":[{"text":"2.1 pom配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-168"},{"type":"header2","children":[{"text":"2.2 项目参数配置"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-174"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"2.3 规则配置"}],"id":"w-e-element-181"},{"type":"header3","children":[{"text":"Sentinel 流控规则配置"}],"textAlign":"start","id":"w-e-element-191"},{"type":"header3","children":[{"text":"Sentinel 熔断规则配置"}],"textAlign":"start","id":"w-e-element-201"},{"type":"header3","children":[{"text":"Sentinel 系统保护规则配置"}],"textAlign":"start","id":"w-e-element-207"},{"type":"header2","children":[{"text":"2.4 规则统一拦截"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-265"},{"type":"header1","children":[{"text":"3.项目运行示例"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-274"},{"type":"header2","children":[{"text":"3.1 规则拦截测试"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-276"},{"type":"header3","children":[{"text":"Sentinel 流控规则测试"}],"textAlign":"start","id":"w-e-element-278"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"3.2 Sentinel 控制台界面展示"}],"id":"w-e-element-291"},{"type":"header3","children":[{"text":"实时监控"}],"textAlign":"start","id":"w-e-element-298"},{"type":"header3","children":[{"text":"簇点链路","bold":true}],"textAlign":"start","id":"w-e-element-299"},{"type":"header3","children":[{"text":"流控规则","bold":true}],"textAlign":"start","id":"w-e-element-307"},{"type":"header1","children":[{"text":"4.控制台数据展示问题"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-365"},{"type":"header2","children":[{"text":"4.1 簇点链路数据为空"}],"textAlign":"start","lineHeight":"1.5","id":"w-e-element-371"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"4.2 实时监控数据为空"}],"id":"w-e-element-420"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"5.Sentinel控制台与Nacos配置中心数据一致性问题"}],"id":"w-e-element-424"},{"type":"header1","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.Sentinel部分核心源码分析"}],"id":"w-e-element-428"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.1 默认slot执行顺序"}],"id":"w-e-element-437"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.2 构建默认责任链"}],"id":"w-e-element-526"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.3 流程总结"}],"id":"w-e-element-567"},{"type":"header2","textAlign":"start","lineHeight":"1.5","children":[{"text":"6.4 编写一个自定义拦截Slot"}],"id":"w-e-element-576"}],"content":"<div id=\\"w-e-textarea-1\\" data-slate-editor=\\"\\" data-slate-node=\\"value\\" suppresscontenteditablewarning=\\"\\" role=\\"textarea\\" spellcheck=\\"true\\" autocorrect=\\"true\\" autocapitalize=\\"true\\" contenteditable=\\"false\\"><h1 id=\\"w-e-element-3\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-20\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.背景</span></span></span></h1><h2 id=\\"w-e-element-21\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-22\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.1 简介</span></span></span></h2><p id=\\"w-e-element-4\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-23\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度保护服务的稳定性。</span></span></span></p><h3 id=\\"w-e-element-91\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-92\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-93\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-94\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 具有以下特征</span></span></span></h3><ul id=\\"w-e-element-26\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-27\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-28\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。</span></span></span></li></ul><ul id=\\"w-e-element-29\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-30\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-31\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。</span></span></span></li></ul><ul id=\\"w-e-element-32\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-33\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-34\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现。</span></span></span></li></ul><ul id=\\"w-e-element-35\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-36\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-37\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">完善的 SPI 扩展机制：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。</span></span></span></li></ul><h3 id=\\"w-e-element-87\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-88\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h3 id=\\"w-e-element-89\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-90\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 的主要特性</span></span></span></h3><ul id=\\"w-e-element-40\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-41\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-42\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">核心库（Java 客户端）不依赖任何框架/库，能够运行于所有 Java 运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。</span></span></span></li></ul><ul id=\\"w-e-element-5\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-6\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-43\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">控制台（Dashboard）基于 Spring Boot 开发，打包后可以直接运行，不需要额外的 Tomcat 等应用容器。</span></span></span></li></ul><h3 id=\\"w-e-element-95\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-96\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-97\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-98\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.2 学习参考</span></span></span></h2><ul id=\\"w-e-element-11\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-12\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-46\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel官方文档：</span></span></span><a href=\\"https://sentinelguard.io/zh-cn/docs/introduction.html\\" target=\\"_blank\\" id=\\"w-e-element-47\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-48\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《官方文档地址》</span></span></span></a><span id=\\"w-e-text-49\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-15\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-16\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-50\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel源码解析：</span></span></span><a href=\\"https://blog.51cto.com/u_14291117/2564243\\" target=\\"_blank\\" id=\\"w-e-element-51\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-52\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel是如何限流的》</span></span></span></a><span id=\\"w-e-text-53\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><ul id=\\"w-e-element-13\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-14\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-54\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel常规知识点：</span></span></span><a href=\\"https://jishuin.proginn.com/p/763bfbd68b3f\\" target=\\"_blank\\" id=\\"w-e-element-17\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\"><span id=\\"w-e-text-55\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">《sentinel连环17问》</span></span></span></a><span id=\\"w-e-text-56\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></li></ul><h3 id=\\"w-e-element-99\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-100\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-101\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-102\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.3 章节介绍</span></span></span></h2><p id=\\"w-e-element-18\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-59\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文主要介绍以下知识点：</span></span></span></p><ul id=\\"w-e-element-60\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-61\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-62\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">基于Spring boot 对接Sentinel;</span></span></span></li></ul><ul id=\\"w-e-element-63\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-64\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-65\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos配置Sentinel规则信息；</span></span></span></li></ul><ul id=\\"w-e-element-66\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-67\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-68\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">测试流控规则，系统保护规则，熔断规则；</span></span></span></li></ul><ul id=\\"w-e-element-69\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-70\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-71\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台数据展示问题；</span></span></span></li></ul><ul id=\\"w-e-element-72\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-73\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-74\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Nacos规则存储与Sentinel修改数据同步问题；</span></span></span></li></ul><ul id=\\"w-e-element-75\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-76\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-77\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel责任链模式分析</span></span></span></li></ul><h1 id=\\"w-e-element-103\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-104\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-105\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-106\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.项目构建</span></span></span></h1><h2 id=\\"w-e-element-168\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-80\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.1 pom配置</span></span></span></h2><pre id=\\"w-e-element-165\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-166\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-167\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token comment\\">&lt;!--        nacos配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-config</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-nacos-discovery</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel配置--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.cloud</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">spring-cloud-starter-alibaba-sentinel</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2.6.RELEASE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">&lt;!--        sentinel 规则基于nacos存储--&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;dependency&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">com.alibaba.csp</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/groupId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel-datasource-nacos</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/artifactId&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.8.3</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/version&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token tag\\" data-slate-string=\\"true\\">&lt;/dependency&gt;</span></span></span></code></pre><h2 id=\\"w-e-element-174\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-170\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.2 项目参数配置</span></span></span></h2><pre id=\\"w-e-element-171\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-172\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-173\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">server:\\r\\n  servlet:\\r\\n    context-path: /sentinel-nacos-demo\\r\\nspring:\\r\\n  application:\\r\\n    name: sentinel-nacos-demo\\r\\n  profiles:\\r\\n    active: local\\r\\n  cloud:\\r\\n    nacos:\\r\\n      config:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        #server-addr: xxx.xxx.xx.x:8848\\r\\ngroup: ${spring.application.name}\\r\\n        file-extension: yaml\\r\\n        # 配置中心使用单独namespace\\r\\nnamespace: \\"study\\"\\r\\n      discovery:\\r\\n        server-addr: xxx.xxx.xx.x:8848\\r\\n        namespace: \\"study\\"\\r\\n        group: \\"sentinel-nocas-demo\\"\\r\\n    sentinel:\\r\\n      transport:\\r\\n        dashboard: xxx.xxx.xx.x:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: 10.32.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败\\r\\ndatasource:\\r\\n        ## 配置流程控制\\r\\n        ## rule-type 配置表示该数据源中的规则属于哪种类型的规则(flow流控，degrade熔断降级，authority授权，system系统保护, param-flow热点参数限流, gw-flow, gw-api-group)\\r\\nflow:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            data-id: ${spring.application.name}-sentinel-flow-rules\\r\\n            group-id: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: flow\\r\\n              ## 配置降级规则\\r\\ndegrade:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-degrade-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: degrade\\r\\n        system:\\r\\n          nacos:\\r\\n            server-addr: xxx.xxx.xx.x:8848\\r\\n            namespace: \\"study\\"\\r\\n            dataId: ${spring.application.name}-sentinel-system-rules\\r\\n            groupId: sentinel-group\\r\\n            data-type: json\\r\\n            rule-type: system</span></span></span></code></pre><h3 id=\\"w-e-element-179\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-180\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-181\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-182\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.3 规则配置</span></span></span></h2><p id=\\"w-e-element-175\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-178\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">在Nacos配置中心中设置如下配置：</span></span></span></p><p id=\\"w-e-element-129\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-128\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-183\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-183\\" class=\\"w-e-image-container\\"><img src=\\"https://p4.qhimg.com/bdr/__85/t012fca6fa6fe728aca.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-184\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-185\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-191\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-187\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则配置</span></span></span></h3><pre id=\\"w-e-element-196\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-197\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-190\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/flow\\",\\r\\n        \\"limitApp\\": \\"default\\",\\r\\n        \\"grade\\": 1,\\r\\n        \\"count\\": 1,\\r\\n        \\"strategy\\": 0,\\r\\n        \\"controlBehavior\\": 0,\\r\\n        \\"clusterMode\\": false\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-201\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-195\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 熔断规则配置</span></span></span></h3><pre id=\\"w-e-element-198\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-199\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-200\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"resource\\": \\"/sentinel/rule/degrade\\",\\r\\n        \\"count\\": 1,\\r\\n        \\"grade\\": 0,\\r\\n        \\"timeWindow\\": 10,\\r\\n        \\"minRequestAmount\\": 1,\\r\\n        \\"statIntervalMs\\": 1000,\\r\\n        \\"slowRatioThreshold\\": 0.1\\r\\n    }\\r\\n]</span></span></span></code></pre><h3 id=\\"w-e-element-207\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-203\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 系统保护规则配置</span></span></span></h3><pre id=\\"w-e-element-204\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-205\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-206\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">[\\r\\n    {\\r\\n        \\"avgRt\\":1,\\r\\n        \\"highestCpuUsage\\":-1,\\r\\n        \\"highestSystemLoad\\":-1,\\r\\n        \\"maxThread\\":-1,\\r\\n        \\"qps\\":1000\\r\\n    }\\r\\n]</span></span></span></code></pre><p id=\\"w-e-element-262\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-161\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h2 id=\\"w-e-element-265\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-266\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.4 规则统一拦截</span></span></span></h2><p id=\\"w-e-element-273\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-210\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-267\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-267\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t01a11e3b13964fd5e9.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-268\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-216\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><pre id=\\"w-e-element-270\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-271\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-272\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Component</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">static</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MyBlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockExceptionHandler</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">handle</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> httpServletRequest</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">HttpServletResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BlockException</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//Sentinel规则的详细信息</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"sentinel-控制拦截\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">FlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"接口限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DegradeException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"服务降级了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ParamFlowException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"热点参数限流了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SystemBlockException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"触发系统保护规则了\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">else</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AuthorityException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n      r </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BaseResponse</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">error</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"授权规则不通过\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">toString</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">//返回json数据</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setStatus</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">500</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setCharacterEncoding</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"utf-8\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">setContentType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">MediaType</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">APPLICATION_JSON_VALUE</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ObjectMapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">writeValue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">response</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getWriter</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> r</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n  </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h1 id=\\"w-e-element-274\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-275\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.项目运行示例</span></span></span></h1><h2 id=\\"w-e-element-276\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-277\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.1 规则拦截测试</span></span></span></h2><h3 id=\\"w-e-element-278\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-279\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 流控规则测试</span></span></span></h3><p id=\\"w-e-element-223\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-222\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-280\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-280\\" class=\\"w-e-image-container\\"><img src=\\"https://p5.qhimg.com/bdr/__85/t016e7066c6ab420738.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-281\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-282\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-288\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-225\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-285\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-285\\" class=\\"w-e-image-container\\"><img src=\\"https://p6.qhimg.com/bdr/__85/t01761d472910cd604c.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-286\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-228\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-289\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-290\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-291\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-292\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">3.2 Sentinel 控制台界面展示</span></span></span></h2><h3 id=\\"w-e-element-298\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-294\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">实时监控</span></span></span><span id=\\"w-e-element-295\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-295\\" class=\\"w-e-image-container\\" style=\\"width: 100%;\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t014be3b3a24ffb638a.jpg\\" alt=\\"\\" style=\\"width: 100%;\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-296\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-297\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></h3><h3 id=\\"w-e-element-299\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-300\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">簇点链路</span></strong></span></span></h3><p id=\\"w-e-element-241\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-240\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-301\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-301\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-302\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-303\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-304\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-243\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-307\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><span id=\\"w-e-text-308\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">流控规则</span></strong></span></span></h3><p id=\\"w-e-element-332\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-246\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-309\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-309\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t01c143c4dc884f79a7.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-310\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-311\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-353\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-334\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h1 id=\\"w-e-element-365\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-370\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.控制台数据展示问题</span></span></span></h1><h2 id=\\"w-e-element-371\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-372\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.1 簇点链路数据为空</span></span></span></h2><p id=\\"w-e-element-373\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-374\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署微服务的服务器存在多个虚拟的ip地址，Sentinel控制台识别了其中一个的ip地址，但是该地址与控制台网络不通。</span></span></span></p><p id=\\"w-e-element-375\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-376\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法（如下两个方法都可以）：</span></span></span></p><p id=\\"w-e-element-377\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-378\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.部署服务器设置一个固定的ip地址；</span></span></span></p><p id=\\"w-e-element-383\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-379\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">2.配置固定的客户端ip地址，如：</span></span></span></p><pre id=\\"w-e-element-380\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-381\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-382\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">sentinel:\\r\\n  transport:\\r\\n    dashboard: xxx.168.16.13:8842  #启动本项目后需要请求一次才能向sentinel控制台注册\\r\\nport: 8719  #当一个服务器部署多个应用时要配置不同port，单个应用可忽略\\r\\nclient-ip: xx.xx.4.230   #指定本机ip地址，避免多个虚拟地址，导致数据获取失败</span></span></span></code></pre><h2 id=\\"w-e-element-418\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-419\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h2><h2 id=\\"w-e-element-420\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-421\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">4.2 实时监控数据为空</span></span></span></h2><p id=\\"w-e-element-396\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-397\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">造成原因：部署维服务的服务器时间与Sentinel控制台所在服务器的时间不一致。</span></span></span></p><p id=\\"w-e-element-385\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-398\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决办法：调整两边服务器的时间，在差距为20秒以内， 数据可展示。</span></span></span></p><h1 id=\\"w-e-element-422\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-423\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-424\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-425\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">5.Sentinel控制台与Nacos配置中心数据一致性问题</span></span></span></h1><p id=\\"w-e-element-401\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-402\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel控制台可以通过簇点链路设置各种规则，但是规则信息不能落地存储。一旦Sentienl服务重启后，规则就会丢失。</span></span></span></p><p id=\\"w-e-element-403\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-404\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">解决方案可以将规则信息存储在Nacos中，这样就可以存储规则信息了。目前版本是在Nacos中设置规则信息后，可以在Sentinel控制台中查看，但在Sentinel控制台修改规则后，不能同步到Nacos中。</span></span></span></p><p id=\\"w-e-element-388\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-405\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">针对这样的情况，解决方案参考如下：</span></span></span></p><ul id=\\"w-e-element-406\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-407\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-408\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">项目组统一规定，规则信息只能基于Nacos配置，在Nacos中做修改调整，不可在Sentinel控制台操作规则信息。</span></span></span></li></ul><ul id=\\"w-e-element-389\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-409\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-410\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">参考目前的一些同步方案，修改Sentinel源代码，支持在控制台变更规则信息后，同步到Nacos中。具体可参考《</span></span></span><span id=\\"w-e-text-411\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><strong class=\\"token bold\\"><span data-slate-string=\\"true\\">SpringBoot Sentinel Nacos (-规则双向同步-自定义响应 》</span></strong></span></span></li><li id=\\"w-e-element-391\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-412\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">个人建议：目前可以先基于Nacos配置统一管理，后续版本应该会支持双向同步，非必要情况下，不必造轮子处理。</span></span></span></li></ul><h1 id=\\"w-e-element-426\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-427\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h1><h1 id=\\"w-e-element-428\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-429\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.Sentinel部分核心源码分析</span></span></span></h1><p id=\\"w-e-element-415\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-416\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">本文分析源码版本：sentinel-core-1.8.1</span></span></span></p><p id=\\"w-e-element-393\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-417\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">Sentinel 将 ProcessorSlot 作为 SPI 接口进行扩，使得 Slot Chain 具备了扩展的能力。开发人员可以自行加入自定义的 slot 并编排 slot 间的执行顺序，从而可以给 Sentinel 添加自定义的功能。</span></span></span></p><p id=\\"w-e-element-250\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-249\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-430\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-430\\" class=\\"w-e-image-container\\"><img src=\\"https://p8.qhimg.com/bdr/__85/t0179da5c3c2aa9e571.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-431\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-432\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><h3 id=\\"w-e-element-435\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-436\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-437\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-438\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.1 默认slot执行顺序</span></span></span></h2><p id=\\"w-e-element-256\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-255\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-439\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-439\\" class=\\"w-e-image-container\\"><img src=\\"https://p3.qhimg.com/bdr/__85/t014f60621f095ece10.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-440\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-441\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-259\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-442\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">slot实现类关系图</span></span></span></p><p id=\\"w-e-element-260\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-261\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-443\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-443\\" class=\\"w-e-image-container\\"><img src=\\"https://p7.qhimg.com/bdr/__85/t01c79d6c25a04165ed.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-444\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-445\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-519\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-512\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">NodeSelectorSlot 的实现类调用关系：</span></span></span></p><pre id=\\"w-e-element-516\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-517\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-518\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">1.定义实现类加载顺序\\r\\n@Spi(isSingleton = false, order = Constants.ORDER_NODE_SELECTOR_SLOT)\\r\\n\\r\\n2.定义NodeSelectorSlot实现类继承自抽象类\\r\\n public class NodeSelectorSlot extends AbstractLinkedProcessorSlot&lt;Object&gt; \\r\\n\\r\\n3.定义抽象类实现接口\\r\\npublic abstract class AbstractLinkedProcessorSlot&lt;T&gt; implements ProcessorSlot&lt;T&gt;\\r\\n\\r\\n4.定义链路顶层接口\\r\\npublic interface ProcessorSlot&lt;T&gt;</span></span></span></code></pre><h3 id=\\"w-e-element-524\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-525\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-526\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-527\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.2 构建默认责任链</span></span></span></h2><p id=\\"w-e-element-531\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-523\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">加载实现了抽象类AbstractLinkedProcessorSlot的链路，若扩展时只实现ProcessorSlot 接口，是不能加入到责任链路中的。参考源码：</span></span></span></p><pre id=\\"w-e-element-528\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-529\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-530\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultSlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">implements</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SlotChainBuilder</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">build</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">List</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;ProcessorSlot&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">SpiLoader</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">of</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">loadInstanceListSorted</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">for</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">:</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> sortedSlotList</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">if</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">!</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">slot </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">instanceof</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"The ProcessorSlot(\\"</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getClass</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">getCanonicalName</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">+</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\") is not an instance of AbstractLinkedProcessorSlot, can\'t be added into ProcessorSlotChain\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n                </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">continue</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n            chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> slot</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">return</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> chain</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-539\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-532\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">历史调用链组装逻辑：调试代码时，发现新版本已经废弃这种调用组装逻辑了。(责任链模式，结合order顺序的模式，便于调整和控制)</span></span></span></p><pre id=\\"w-e-element-536\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-537\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-538\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" class=\\"token keyword\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ProcessorSlotChain</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;Object&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the head of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addFirst</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n     * Add a processor to the tail of this slot chain.\\r\\n     *\\r\\n     * @param protocolProcessor processor to be added.\\r\\n     */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">abstract</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">addLast</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;?&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> protocolProcessor</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><h3 id=\\"w-e-element-565\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-566\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-567\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-568\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.3 流程总结</span></span></span></h2><ul id=\\"w-e-element-544\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-545\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-546\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">采用责任链模式完成Sentinel的信息统计、熔断、限流等操作；</span></span></span></li></ul><ul id=\\"w-e-element-547\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-548\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-549\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中NodeSelectSlot负责选择当前资源对应的Node，同时构建node调用树；</span></span></span></li></ul><ul id=\\"w-e-element-550\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-551\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-552\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中ClusterBuilderSlot负责构建当前Node对应的ClusterNode，用于聚合同一资源对应不同Context的Node；</span></span></span></li></ul><ul id=\\"w-e-element-553\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-554\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-555\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的StatisticSlot用于统计当前资源的调用情况，更新Node与其对用的ClusterNode的各种统计数据；</span></span></span></li></ul><ul id=\\"w-e-element-556\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-557\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-558\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">责任链中的FlowSlot根据当前Node对应的ClusterNode（默认）的统计信息进行限流；</span></span></span></li></ul><ul id=\\"w-e-element-559\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-560\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-561\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">资源调用统计数据（例如PassQps）使用滑动时间窗口进行统计；</span></span></span></li></ul><ul id=\\"w-e-element-540\\" data-slate-node=\\"element\\" style=\\"text-align: start;\\"><li id=\\"w-e-element-541\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-562\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">所有工作执行完毕后，执行退出流程，补充一些统计数据，清理Context。</span></span></span></li></ul><h3 id=\\"w-e-element-569\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-570\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></h3><h2 id=\\"w-e-element-576\\" data-slate-node=\\"element\\" style=\\"text-align: start; line-height: 1.5;\\"><span id=\\"w-e-text-572\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">6.4 编写一个自定义拦截Slot</span></span></span></h2><pre id=\\"w-e-element-573\\" data-slate-node=\\"element\\"><code id=\\"w-e-element-574\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-575\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span class=\\"token comment\\" data-slate-string=\\"true\\">/**\\r\\n * 编写一个自定义限流链路\\r\\n *\\r\\n * @author wangling\\r\\n * @date 2022/07/05\\r\\n */</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Spi</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">order </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">=</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token operator\\" data-slate-string=\\"true\\">-</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token number\\" data-slate-string=\\"true\\">3000</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">class</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">TestMySlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">extends</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">AbstractLinkedProcessorSlot</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">&lt;DefaultNode&gt;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">entry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">DefaultNode</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">boolean</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throws</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireEntry</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> obj</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> prioritized</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">new</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">BusinessException</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"TestMySlot-测试\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Exception</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">throw</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">@Override</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">public</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">void</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">exit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Context</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">ResourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">int</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Object</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">try</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">fireExit</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">context</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> resourceWrapper</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> count</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> args</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token keyword\\" data-slate-string=\\"true\\">catch</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">Throwable</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">{</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n            </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token class-name\\" data-slate-string=\\"true\\">RecordLog</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">.</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token function\\" data-slate-string=\\"true\\">warn</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">(</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token string\\" data-slate-string=\\"true\\">\\"Unexpected entry exit exception\\"</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">,</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\"> e</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">)</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">;</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n        </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n    </span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\">\\r\\n</span></span><span data-slate-leaf=\\"true\\"><span class=\\"token punctuation\\" data-slate-string=\\"true\\">}</span></span></span></code></pre><p id=\\"w-e-element-476\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-641\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-string=\\"true\\" style=\\"color: rgb(68, 68, 68); background-color: rgb(255, 255, 255); font-size: 16px;\\">配置SPI自动扫描</span></span></span></p><p id=\\"w-e-element-479\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-478\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span><span id=\\"w-e-element-642\\" data-slate-node=\\"element\\" data-slate-inline=\\"true\\" data-slate-void=\\"true\\" style=\\"position: relative;\\"><div id=\\"w-e-image-container-642\\" class=\\"w-e-image-container\\"><img src=\\"https://p2.qhimg.com/bdr/__85/t01afc2df45a8320bfb.jpg\\" alt=\\"\\"></div><span data-slate-spacer=\\"true\\" style=\\"height: 0px; color: transparent; outline: none; position: absolute;\\"><span id=\\"w-e-text-643\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"z\\">\ufeff</span></span></span></span></span><span id=\\"w-e-text-644\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-482\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-481\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p><p id=\\"w-e-element-510\\" data-slate-node=\\"element\\"><span id=\\"w-e-text-511\\" data-slate-node=\\"text\\"><span data-slate-leaf=\\"true\\"><span data-slate-zero-width=\\"n\\">\ufeff<br></span></span></span></p></div>"}]}')},5313:function(a,t,e){"use strict";e.r(t);var s=e("b85c"),n=(e("e9c4"),e("fb6a"),e("96eb")),l=e.n(n),p=e("4fd3");l.a.mock("/luochen/data","get",(function(){return p})),l.a.mock("/luochen/document/details","get",(function(a){var t,e=JSON.parse(a.body),n=Object(s["a"])(p.documentList);try{for(n.s();!(t=n.n()).done;){var l=t.value;if(l.id===e.id)return{code:2e3,data:l,message:"获取成功"}}}catch(r){n.e(r)}finally{n.f()}return{code:4004,data:{},message:"查询的key不存在"}})),l.a.mock("/luochen/document/list","get",(function(a){var t=JSON.parse(a.body),e=t.page?t.page:1,s=t.rows?t.rows:4,n=(e-1)*s,l=n+s,r=JSON.parse(JSON.stringify(p.documentList)).reverse(),d={list:r.slice(n,l),total:r.length};return{code:2e3,data:d,message:"获取成功"}})),l.a.mock("/luochen/document/recom/list","get",(function(){for(var a=0,t=[],e=JSON.parse(JSON.stringify(p.documentList)).reverse(),s=0;s<e.length;s++)if(e[s].label.length>1&&(t.push(e[s]),a++),4===a)break;return{code:2e3,data:t,message:"获取成功"}})),l.a.mock("/luochen/tag/list","get",(function(a){for(var t=JSON.parse(a.body),e=t.page?t.page:1,s=t.rows?t.rows:4,n=(e-1)*s,l=[],r=0,d=n;d<p.tagList.length;d++){if(r===s)break;l.push(p.tagList[d]),r++}return{code:2e3,data:l,message:"获取成功"}})),l.a.mock("/luochen/document/new/list","get",(function(){var a=JSON.parse(JSON.stringify(p.documentList)).reverse();return{code:2e3,data:a.slice(0,10),message:"获取成功"}})),l.a.mock("/luochen/document/statistics","get",(function(){var a={};a.document=p.documentList.length;var t,e=0,n=Object(s["a"])(p.documentList);try{for(n.s();!(t=n.n()).done;){var l=t.value;l.label.length>0&&(e+=1)}}catch(r){n.e(r)}finally{n.f()}return a.recom=e,a.tag=p.tagList.length,a.document>0?a.datetime=p.documentList[a.document-1].datetime:a.datetime=0,{code:2e3,data:a,message:"获取成功"}})),l.a.mock("/luochen/navigation/list","get",(function(){return{code:2e3,data:p.navigationList,message:"获取成功"}}))},"56d7":function(a,t,e){"use strict";e.r(t);e("e260"),e("e6cf"),e("cca6"),e("a79d"),e("d3b7"),e("159b");var s=e("2b0e"),n=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},l=[],p={name:"App",created:function(){this.bodyScale()},methods:{bodyScale:function(){var a=document.documentElement.clientWidth;document.body.style.zoom=a/1519.2}}},r=p,d=(e("034f"),e("2877")),u=Object(d["a"])(r,n,l,!1,null,null,null),i=u.exports,o=e("8c4f"),c=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("a-row",[e("a-col",{attrs:{span:24}},[a._e()]),e("a-col",{attrs:{span:24}},[e("div",{staticClass:"index-content-box"},[e("router-view")],1)])],1)},g=[],f={name:"IndexView",methods:{clickNavMenuHander:function(a){console.log(a),console.log(a.currentTarget)}}},m=f,x=(e("a258"),Object(d["a"])(m,c,g,!1,null,"05e1f01e",null)),k=x.exports,w=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"main-content-box"},[e("div",{staticClass:"main-content-author-box"},[e("author-cart-bar")],1),e("a-row",{attrs:{gutter:[16,16]}},[e("a-col",{attrs:{span:5}},[e("div",{staticClass:"main-card-item-box"},[e("main-card-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("专栏")]),e("ul",{staticClass:"special-column-box",attrs:{slot:"content"},slot:"content"},a._l(a.specialColumnList,(function(t,s){return e("li",{key:s},[e("a",[a._v(a._s(t.name))]),a._v(" "),e("span",[a._v(a._s(t.count)+"篇")])])})),0)])],1),e("div",{staticClass:"main-card-item-box"},[e("main-card-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("专栏")]),e("ul",{staticClass:"special-column-box",attrs:{slot:"content"},slot:"content"},a._l(7,(function(t){return e("li",{key:t},[a._v("xx")])})),0)])],1),e("div",{staticClass:"main-card-item-box"},[e("main-card-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("专栏")]),e("ul",{staticClass:"special-column-box",attrs:{slot:"content"},slot:"content"},a._l(7,(function(t){return e("li",{key:t},[a._v("xx")])})),0)])],1)]),e("a-col",{attrs:{span:19}},[e("div",{staticClass:"main-content-list-box"},[e("document-list-bar")],1)])],1)],1)])},h=[],y=function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",[s("div",{staticClass:"author-card-box"},[s("a-row",[s("a-col",{attrs:{span:2}},[s("div",{staticClass:"author-card-img"},[s("img",{attrs:{src:e("3fdb"),alt:""}})])]),s("a-col",{attrs:{span:22}},[s("div",{staticClass:"author-card-text"},[s("h2",[a._v("洛尘")]),s("p",[s("span",[a._v("212121")]),a._v(" 总访问量 | "),s("span",[a._v("32")]),a._v(" 原创 | "),s("span",[a._v("877")]),a._v(" 粉丝 ")]),s("p",[a._v("博客描述：芝兰生于幽谷，不以无人而不芳！")])])])],1)],1)])},b=[],S={name:"AuthorCartBar"},v=S,z=(e("0494"),Object(d["a"])(v,y,b,!1,null,"41a356ae",null)),A=z.exports,_=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"main-card-box"},[e("div",{staticClass:"main-card-title"},[a._t("title")],2),e("div",{staticClass:"main-card-body"},[a._t("content")],2)])])},C=[],L={name:"MainCardBar"},j=L,I=(e("9d10"),Object(d["a"])(j,_,C,!1,null,"65bbb641",null)),P=I.exports,N=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"document-list-box"},[e("div",{staticClass:"document-list-title-box"},[e("a-row",[e("a-col",{attrs:{span:20}},[e("a",{staticClass:"document-list-title-item document-list-title-activate"},[a._v("最近")]),e("a",{staticClass:"document-list-title-item"},[a._v("文章")])]),e("a-col",{attrs:{span:4}},[e("div",{staticClass:"document-list-title-search-box"},[e("input"),e("span",[e("a-icon",{attrs:{type:"search"}})],1)])])],1)],1),e("div",{staticClass:"document-list-body-box"},a._l(a.documentList,(function(t,s){return e("div",{key:s,staticClass:"document-list-body-item"},[e("div",{staticClass:"document-list-body-item-title"},[e("router-link",{attrs:{to:"/document/"+t.id}},[a._v(a._s(t.title))])],1),e("p",[a._v(a._s(a.showText(t.abstract)))]),e("div",{staticClass:"document-list-body-item-footer"},[e("span",[a._v(a._s(0===t.label.length?"原创":t.label))]),e("a-divider",{attrs:{type:"vertical"}}),a._v(" 发布时间 "+a._s(a.timestamp(t.datetime))+" "),e("a-divider",{attrs:{type:"vertical"}}),a._v(" "+a._s(t.action.read)+" 阅读 ")],1)])})),0)])])},E=[],H=(e("e9c4"),e("caad"),e("2532"),e("bc3a")),R=e.n(H),B=e("56cd"),O=R.a.create({timeout:3e3});O.interceptors.request.use((function(a){return a.data=JSON.stringify(a.data),a.headers={"Content-Type":"application/json"},a}),(function(a){Promise.reject(a)})),O.interceptors.response.use((function(a){return a.data}),(function(a){if(a&&a.response)switch(a.response.status){case 400:a.message="错误请求";break;case 401:a.message="未授权，请重新登录";break;case 403:a.message="拒绝访问";break;case 404:a.message="请求错误,未找到该资源",window.location.href="/NotFound";break;case 405:a.message="请求方法未允许";break;case 408:a.message="请求超时";break;case 500:a.message="服务器端出错";break;case 501:a.message="网络未实现";break;case 502:a.message="网络错误";break;case 503:a.message="服务不可用";break;case 504:a.message="网络超时";break;case 505:a.message="http版本不支持该请求";break;default:a.message="连接错误".concat(a.response.status)}else JSON.stringify(a).includes("timeout")&&B["a"].error({placement:"bottomRight",bottom:"50px",duration:3,description:"服务器响应超时，请刷新当前页"}),a.message("连接服务器失败");return B["a"].error({placement:"bottomRight",bottom:"50px",duration:3,description:a.message}),Promise.resolve(a.response)}));var T=O,q={get:function(a,t){var e={method:"get",url:a,data:t};return T(e)},post:function(a,t){var e={method:"post",url:a,data:t};return T(e)},put:function(a,t){var e={method:"put",url:a,data:t};return T(e)},delete:function(a,t){var e={method:"delete",url:a,data:t};return T(e)}},D=q,M={getData:function(){return D.get("/luochen/data",{})},getDocumentDetails:function(a){return D.get("/luochen/document/details",{id:a})},getDocumentList:function(a){return D.get("/luochen/document/list",a)},getRecomDocumentList:function(){return D.get("/luochen/document/recom/list",{})},getTagList:function(){return D.get("/luochen/tag/list",{})},getNewDocumentList:function(){return D.get("/luochen/document/new/list",{})},getDocumentStatistics:function(){return D.get("/luochen/document/statistics",{})},getNavigationList:function(){return D.get("/luochen/navigation/list",{})}},W=M,F=(e("ac1f"),e("5319"),e("25f0"),{textShow:function(a){return a&&a.length>163?a.substring(0,163)+"...":a},timestamp:function(a){var t=new Date(a);return t.getFullYear()+"-"+this.addZero(t.getMonth()+1)+"-"+this.addZero(t.getDate())+" "+this.addZero(t.getHours())+":"+this.addZero(t.getSeconds())},timestampShow:function(a){var t=new Date(a);return t.getFullYear()+"-"+this.addZero(t.getMonth()+1)+"-"+this.addZero(t.getDate())},simpleTimestamp:function(a){var t=new Date(a);return this.addZero(t.getMonth()+1)+"/"+this.addZero(t.getDate())},addZero:function(a){return a>9?a:"0"+a},getuuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){var t=16*Math.random()|0,e="x"===a?t:3&t|8;return e.toString(16)}))},getRandom:function(){return Math.ceil(1e4*Math.random())+100},saveFile:function(a,t){saveAs(new File([t],a,{type:"text/plain;charset=utf-8"}))},documentListColumns:function(){return[{title:"文章标题",dataIndex:"title-info",key:"title-info",width:380,scopedSlots:{customRender:"title-info"}},{title:"阅读 | 点赞 | 评论",dataIndex:"number",key:"number",scopedSlots:{customRender:"number"}},{title:"文章标签集",dataIndex:"tagList",key:"tagList",scopedSlots:{customRender:"tagList"}},{title:"创建时间",dataIndex:"datetime",key:"datetime",scopedSlots:{customRender:"datetime"}},{title:"文章状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"action",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"}}]},navListColumns:function(){return[{title:"导航分组",dataIndex:"group",key:"group"},{title:"链接数",dataIndex:"groupNum",key:"groupNum",scopedSlots:{customRender:"groupNum"}}]},navListSubColumns:function(){return[{title:"导航名称",dataIndex:"name",key:"name"},{title:"导航链接",dataIndex:"link",key:"link"},{title:"链接图片",dataIndex:"img",key:"img",scopedSlots:{customRender:"img"}}]}}),J=F,K={name:"DocumentListBar",data:function(){return{documentList:[]}},mounted:function(){var a=this;W.getDocumentList({page:1,rows:10}).then((function(t){2e3===t.code&&(console.log(t.data),a.documentList=t.data.list)}))},methods:{showText:function(a){return a.length>240?a.substring(0,240)+"...":a},timestamp:function(a){return J.timestamp(a)}}},U=K,V=(e("a977"),Object(d["a"])(U,N,E,!1,null,"28ed45ce",null)),Q=V.exports,G={name:"IndexMain",data:function(){return{specialColumnList:[{name:"java虚拟机",count:32},{name:"java虚拟机",count:32},{name:"java虚拟机",count:32}]}},mounted:function(){},methods:{},components:{AuthorCartBar:A,MainCardBar:P,DocumentListBar:Q}},Z=G,Y=(e("3508"),Object(d["a"])(Z,w,h,!1,null,"521b190e",null)),X=Y.exports,aa=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:a.loadingStatus,expression:"loadingStatus"}],staticClass:"document-main-load-box"},[e("a-spin",{attrs:{size:"large",tip:"玩命加载中..."}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!a.loadingStatus,expression:"!loadingStatus"}],staticClass:"document-main-box"},[e("a-row",{attrs:{gutter:[16,16]}},[e("a-col",{attrs:{span:5}},[e("div",{staticClass:"main-card-item-box catalogue"},[e("main-card-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("目录")]),e("catalogue-bar",{attrs:{slot:"content",catalogue:a.documentInfo.catalogue},slot:"content"})],1)],1)]),e("a-col",{attrs:{span:19}},[e("div",{staticClass:"document-main-right-box"},[e("div",{staticClass:"document-main-content-box"},[e("div",{staticClass:"document-main-header"},[e("h1",[a._v(a._s(a.documentInfo.title))]),e("p",[a._v(a._s(a.documentInfo.abstract))])]),e("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"document-main-content",domProps:{innerHTML:a._s(a.documentInfo.content)}})])])])],1)],1)])},ta=[];e("3ca3"),e("ddb0");window.onload=function(){};var ea={showBigImg:function(a){$("body").append("<div class='mask-box'><img src="+a+" alt=''/></div>"),document.body.style.overflow="hidden",document.body.style.height="100%",$(".mask-box").on("click",(function(){$(".mask-box").remove(),document.body.style.overflow="visible",document.body.style.height="auto"}))}},sa=ea,na=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("ul",{staticClass:"catalogue-bar-box"},a._l(a.catalogue,(function(t,s){return e("li",{key:s,class:t.type},[a._v(" "+a._s(t.children[0].text)+" ")])})),0)])},la=[],pa={name:"CatalogueBar",props:{catalogue:{type:Array,default:function(){return[]}}}},ra=pa,da=(e("6238"),Object(d["a"])(ra,na,la,!1,null,"5051310e",null)),ua=da.exports;e.e("chunk-76d63715").then(e.t.bind(null,"8ffd",7));var ia={name:"DocumentMain",data:function(){return{loadingStatus:!1,documentInfo:{action:{like:0,read:0,comment:0}}}},mounted:function(){var a=this;this.loadingStatus=!0,W.getDocumentDetails(this.$route.params.id).then((function(t){2e3===t.code&&(a.documentInfo=t.data),a.loadingStatus=!1})),$(".document-main-content").on("click","img",(function(a){sa.showBigImg($(a.currentTarget).attr("src"))}))},methods:{timestampShow:function(a){return J.timestampShow(a)},simpleTimestamp:function(a){return J.simpleTimestamp(a)}},components:{MainCardBar:P,CatalogueBar:ua}},oa=ia,ca=(e("c635"),Object(d["a"])(oa,aa,ta,!1,null,"02c99964",null)),ga=ca.exports,fa=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("a-layout",{attrs:{id:"components-layout-demo-custom-trigger"}},[e("a-layout-sider",{attrs:{trigger:null,collapsible:"",theme:"light"},model:{value:a.collapsed,callback:function(t){a.collapsed=t},expression:"collapsed"}},[e("div",{staticClass:"logo"}),e("a-menu",{attrs:{theme:"light",mode:"inline","open-keys":a.openKeys},on:{openChange:a.onOpenChange}},[e("a-sub-menu",{key:"sub1"},[e("span",{attrs:{slot:"title"},slot:"title"},[e("a-icon",{attrs:{type:"mail"}}),e("span",[a._v("首页管理")])],1),e("a-menu-item",{key:"sub1-1"},[e("router-link",{attrs:{to:"/backend","data-key":"sub1-1"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("首页文章")])],1)],1),e("a-menu-item",{key:"sub1-2"},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("首页文章")])],1)],1),e("a-sub-menu",{key:"sub2"},[e("span",{attrs:{slot:"title"},slot:"title"},[e("a-icon",{attrs:{type:"mail"}}),e("span",[a._v("文章管理")])],1),e("a-menu-item",{key:"sub2-1"},[e("router-link",{attrs:{to:"/backend/document","data-key":"sub2-1"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("管理文章")])],1)],1),e("a-menu-item",{key:"sub2-2"},[e("router-link",{attrs:{to:"/backend/document/list","data-key":"sub2-2"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("管理列表")])],1)],1),e("a-menu-item",{key:"sub2-3"},[e("router-link",{attrs:{to:"/backend/document/add","data-key":"sub2-3"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("添加文章")])],1)],1)],1),e("a-sub-menu",{key:"sub3"},[e("span",{attrs:{slot:"title"},slot:"title"},[e("a-icon",{attrs:{type:"mail"}}),e("span",[a._v("导航管理")])],1),e("a-menu-item",{key:"sub3-1"},[e("router-link",{attrs:{to:"/backend/navigation/list","data-key":"sub3-1"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("导航列表")])],1)],1),e("a-menu-item",{key:"sub3-2"},[e("router-link",{attrs:{to:"/backend/navigation/add","data-key":"sub3-2"}},[e("a-icon",{attrs:{type:"android"}}),a._v(" "),e("span",[a._v("导航添加")])],1)],1)],1)],1)],1),e("a-layout",[e("a-layout-header",{staticStyle:{background:"#fff",padding:"0","border-bottom":"#ebeef5 solid 1px"}},[e("a-icon",{staticClass:"trigger",attrs:{type:a.collapsed?"menu-unfold":"menu-fold"},on:{click:function(){return a.collapsed=!a.collapsed}}})],1),e("a-layout-content",{style:{padding:"24px",background:"#fff",minHeight:"280px",height:"auto"}},[e("div",{staticClass:"breadcrumb-box"},[e("a-breadcrumb",[e("a-breadcrumb-item",[a._v("Home")]),e("a-breadcrumb-item",[e("a",{attrs:{href:""}},[a._v("Center")])]),e("a-breadcrumb-item",[e("a",{attrs:{href:""}},[a._v("List")])]),e("a-breadcrumb-item",[a._v("Application")])],1)],1),e("router-view")],1)],1)],1)],1)},ma=[],xa=(e("7db0"),{name:"BackendIndex",data:function(){return{collapsed:!1,rootSubmenuKeys:["sub1","sub2","sub3"],openKeys:["sub1-1"]}},methods:{onOpenChange:function(a){var t=this,e=a.find((function(a){return-1===t.openKeys.indexOf(a)}));-1===this.rootSubmenuKeys.indexOf(e)?this.openKeys=a:this.openKeys=e?[e]:[]}}}),ka=xa,wa=(e("5ffc"),Object(d["a"])(ka,fa,ma,!1,null,"da0cd060",null)),ha=wa.exports,ya=function(){var a=this,t=a.$createElement;a._self._c;return a._m(0)},ba=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("h1",[a._v("login")])])}],Sa={name:"BackendLogin"},va=Sa,za=Object(d["a"])(va,ya,ba,!1,null,"4981bd3c",null),Aa=za.exports,_a=function(){var a=this,t=a.$createElement;a._self._c;return a._m(0)},Ca=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("h1",[a._v("backend main")])])}],La={name:"BackendMain"},ja=La,Ia=Object(d["a"])(ja,_a,Ca,!1,null,"0d5d97e4",null),Pa=Ia.exports,Na=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("backend-title-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("文章管理")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action1",type:"primary"},slot:"action1"},[e("a-icon",{attrs:{type:"save"}}),a._v(" "),e("span",[a._v("保存")])],1),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action2",type:"primary"},slot:"action2"},[e("a-icon",{attrs:{type:"export"}}),a._v(" "),e("span",[a._v("导出")])],1)],1),e("div",{staticClass:"header-box"},[e("a-row",[e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-box header-item-frist-box"},[e("a-row",[e("a-col",{attrs:{span:16,offset:2}},[e("h4",{staticClass:"header-item-title"},[a._v("总文档数")]),e("h3",{staticClass:"header-item-num"},[a._v(a._s(a.documentStatistics.document))])]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-icon"},[e("a-icon",{attrs:{type:"deployment-unit"}})],1)])],1)],1)]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-box"},[e("a-row",[e("a-col",{attrs:{span:16,offset:2}},[e("h4",{staticClass:"header-item-title"},[a._v("推荐文章数")]),e("h3",{staticClass:"header-item-num"},[a._v(a._s(a.documentStatistics.recom))])]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-icon"},[e("a-icon",{attrs:{type:"gold"}})],1)])],1)],1)]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-box"},[e("a-row",[e("a-col",{attrs:{span:16,offset:2}},[e("h4",{staticClass:"header-item-title"},[a._v("标签数")]),e("h3",{staticClass:"header-item-num"},[a._v(a._s(a.documentStatistics.tag))])]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-icon"},[e("a-icon",{attrs:{type:"apartment"}})],1)])],1)],1)]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-box"},[e("a-row",[e("a-col",{attrs:{span:16,offset:2}},[e("h4",{staticClass:"header-item-title"},[a._v("最后新增")]),e("h3",{staticClass:"header-item-datetime"},[a._v(a._s(a.timestamp(a.documentStatistics.datetime)))])]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"header-item-icon"},[e("a-icon",{attrs:{type:"video-camera"}})],1)])],1)],1)])],1)],1),e("div",{staticClass:"body-list-box"},[e("a-row",[e("a-col",{attrs:{span:16}},[e("div",{staticClass:"body-list-item-box"},[e("div",{staticClass:"body-list-item-header"},[a._v("推荐文章")]),e("div",{staticClass:"body-list-item-body"},[e("div",{staticClass:"body-list-item-body-item-x"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("封面")])]),e("a-col",{attrs:{span:7}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("文章标题")])]),e("a-col",{attrs:{span:3,offset:1}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("点赞数")])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("阅读数")])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("评论数")])]),e("a-col",{attrs:{span:5}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("发布时间")])])],1)],1),a._l(a.recomDocumentList,(function(t,s){return e("div",{key:s,staticClass:"body-list-item-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("img",{staticClass:"body-list-item-body-item-img",attrs:{src:"https://htmlstream.com/front-dashboard/assets/img/400x400/img4.jpg",alt:""}})]),e("a-col",{attrs:{span:7}},[e("h4",{staticClass:"body-list-item-body-item-title"},[a._v(a._s(t.title))])]),e("a-col",{attrs:{span:3,offset:1}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("3223")])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("3223")])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("3223")])]),e("a-col",{attrs:{span:5}},[e("div",{staticClass:"body-list-item-body-item-num"},[a._v("2020-10-10 10:10:10")])])],1)],1)}))],2)])]),e("a-col",{attrs:{span:8}},[e("div",{staticClass:"tag-list-box"},[e("div",{staticClass:"tag-list-x-box"},[e("div",{staticClass:"body-list-item-header"},[a._v("标签关联的文章")]),e("div",{staticClass:"tag-list-x-body-box"},[e("div",{staticClass:"tag-list-y-body-item"},[e("a-row",[e("a-col",{attrs:{span:10,offset:2}},[e("div",{staticClass:"tag-list-x-body-item-text"},[e("a-icon",{attrs:{type:"tag"}}),a._v(" "),e("span",[a._v("标签名称")])],1)]),e("a-col",{attrs:{span:8,offset:1}},[e("div",{staticClass:"tag-list-x-body-item-text"},[a._v("关联文章数")])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"tag-list-x-body-item-text"},[a._v("操作")])])],1)],1),a._l(a.tagList,(function(t,s){return e("div",{key:s,staticClass:"tag-list-x-body-item"},[e("a-row",[e("a-col",{attrs:{span:10,offset:2}},[e("div",{staticClass:"tag-list-x-body-item-text"},[e("a-icon",{attrs:{type:"tag"}}),a._v(" "),e("span",[a._v(a._s(t.name))])],1)]),e("a-col",{attrs:{span:8,offset:1}},[e("div",{staticClass:"tag-list-x-body-item-text"},[a._v(a._s(t.documentIdList.length))])]),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"tag-list-x-body-item-text"},[e("a-dropdown",[e("a",[e("a-icon",{attrs:{type:"setting"}})],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",[e("a-icon",{attrs:{type:"edit"}}),a._v(" "),e("span",[a._v("编辑")])],1),e("a-menu-item",[e("a-icon",{attrs:{type:"delete"}}),a._v(" "),e("span",[a._v("删除")])],1)],1)],1)],1)])],1)],1)}))],2)])])])],1)],1)],1)},Ea=[],Ha=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"header-btn-box"},[e("a-row",[e("a-col",{attrs:{span:4}},[e("div",{staticClass:"header-btn-title"},[a._t("title")],2)]),e("a-col",{attrs:{span:2,offset:15}},[a._t("action1")],2),e("a-col",{attrs:{span:2,offset:1}},[a._t("action2")],2)],1)],1)},Ra=[],Ba={name:"BackendTitleBar"},Oa=Ba,Ta=(e("9c39"),Object(d["a"])(Oa,Ha,Ra,!1,null,"ed76cd9a",null)),qa=Ta.exports,Da={name:"BackendDocument",data:function(){return{recomDocumentList:[],recomPagination:{page:1,rows:4},tagList:[],documentStatistics:{document:0,tag:0,recom:0,datetime:0}}},mounted:function(){var a=this;W.getTagList().then((function(t){2e3===t.code&&(a.tagList=t.data)})),W.getRecomDocumentList(this.recomPagination).then((function(t){2e3===t.code&&(a.recomDocumentList=t.data)})),W.getDocumentStatistics().then((function(t){2e3===t.code&&(a.documentStatistics=t.data)}))},methods:{timestamp:function(a){return J.timestamp(a)}},components:{BackendTitleBar:qa}},Ma=Da,Wa=(e("7a6f"),Object(d["a"])(Ma,Na,Ea,!1,null,"7e336aba",null)),$a=Wa.exports,Fa=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("backend-title-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("文章列表")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action1",type:"primary"},on:{click:a.saveEditDocumenthandler},slot:"action1"},[e("a-icon",{attrs:{type:"save"}}),a._v(" "),e("span",[a._v("保存")])],1),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action2",type:"primary"},slot:"action2"},[e("a-icon",{attrs:{type:"export"}}),a._v(" "),e("span",[a._v("导出")])],1)],1),e("div",{staticClass:"document-list-body-box"},[e("a-table",{attrs:{columns:a.columns,"data-source":a.documentList,"row-selection":a.rowSelection,pagination:a.pagination,"expanded-row-keys":a.expandedRowKeys,rowKey:"id"},on:{"update:expandedRowKeys":function(t){a.expandedRowKeys=t},"update:expanded-row-keys":function(t){a.expandedRowKeys=t},change:a.paginationHandler},scopedSlots:a._u([{key:"title-info",fn:function(t,s){return e("div",{staticClass:"list-title-box"},[e("a-row",[e("a-col",{attrs:{span:6}},[e("div",{staticClass:"list-title-img",class:""!==s.label?"list-title-img-star":""},[e("img",{attrs:{src:s.img,alt:"",title:s.tag}})])]),e("a-col",{attrs:{span:18}},[e("div",{staticClass:"list-title-text"},[e("div",[a._v(a._s(s.title))]),e("div",[a._v(a._s(s.abstract))])])])],1)],1)}},{key:"tagList",fn:function(t){return e("div",{},a._l(t,(function(t,s){return e("a-tag",{key:s,attrs:{color:"orange"}},[a._v(a._s(t))])})),1)}},{key:"number",fn:function(t,s){return e("span",{},[a._v(" "+a._s(s.action.read)+" | "+a._s(s.action.like)+" | "+a._s(s.action.comment)+" ")])}},{key:"datetime",fn:function(t){return e("span",{},[a._v(" "+a._s(a.timestamp(t))+" ")])}},{key:"status",fn:function(t,s){return e("div",{},[e("a-select",{staticStyle:{width:"100px"},attrs:{"default-value":s.status?"1":"0"},on:{change:function(t){return a.changeDocumentStatusHandler(s.id,t)}}},[e("a-select-option",{attrs:{value:"1"}},[e("span",{staticClass:"docu-status-enable"},[e("a-icon",{attrs:{type:"api"}}),a._v(" "),e("span",[a._v("启动")])],1)]),e("a-select-option",{attrs:{value:"0"}},[e("span",{staticClass:"docu-status-disable"},[e("a-icon",{attrs:{type:"api"}}),a._v(" "),e("span",[a._v("停用")])],1)])],1)],1)}},{key:"action",fn:function(t,s){return e("div",{},[e("a-dropdown-button",{on:{click:function(t){return a.editDocumentHander(s)}}},[e("a-icon",{attrs:{type:"edit"}}),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",{key:"1"},[e("a-icon",{attrs:{type:"user"}}),a._v("1st menu item ")],1),e("a-menu-item",{key:"2"},[""!==s.label?e("a",{staticClass:"document-btn",on:{click:function(t){return a.starDocumentHandler(s.id,"")}}},[e("a-icon",{attrs:{type:"star",theme:"twoTone","two-tone-color":"#377dff"}}),a._v(" "),e("span",[a._v("取消推荐")])],1):e("a",{staticClass:"document-btn",on:{click:function(t){return a.starDocumentHandler(s.id,"推荐")}}},[e("a-icon",{attrs:{type:"star"}}),a._v(" "),e("span",[a._v("设置为推荐")])],1)]),e("a-menu-item",{key:"3"},[e("a",{staticClass:"document-btn",on:{click:function(t){return a.deleteDocumentHandler(s.id)}}},[e("a-icon",{attrs:{type:"delete"}}),a._v(" "),e("span",[a._v("删除")])],1)])],1),e("a-icon",{attrs:{slot:"icon",type:"down"},slot:"icon"})],1)],1)}}])})],1)],1)},Ja=[],Ka=e("b85c"),Ua=(e("b0c0"),e("a434"),{saveEditData:function(a){var t=this;W.getData().then((function(e){e.documentList=a;var s,n=Object(Ka["a"])(a);try{for(n.s();!(s=n.n()).done;){var l=s.value;e.tagList=t.tagListHandler(e.tagList,l)}}catch(p){n.e(p)}finally{n.f()}}))},saveDataToFile:function(a){var t=this;W.getData().then((function(e){e.documentList=a;var s,n=Object(Ka["a"])(a);try{for(n.s();!(s=n.n()).done;){var l=s.value;e.tagList=t.tagListHandler(e.tagList,l)}}catch(p){n.e(p)}finally{n.f()}J.saveFile("data.json",JSON.stringify(e))}))},tagListHandler:function(a,t){if(a.length>0){var e,s=Object(Ka["a"])(t.tagList);try{for(s.s();!(e=s.n()).done;){var n=e.value,l=this.tagListSearchHandler(a,n);l?l.documentIdList.push(t.id):a.push({name:n,documentIdList:[t.id]})}}catch(u){s.e(u)}finally{s.f()}}else{var p,r=Object(Ka["a"])(t.tagList);try{for(r.s();!(p=r.n()).done;){var d=p.value;a.push({name:d,documentIdList:[t.id]})}}catch(u){r.e(u)}finally{r.f()}}return a},tagListSearchHandler:function(a,t){var e,s=Object(Ka["a"])(a);try{for(s.s();!(e=s.n()).done;){var n=e.value;if(n.name===t)return n}}catch(l){s.e(l)}finally{s.f()}},deleteDocumentInfo:function(a){console.log(a),W.queryData().then((function(t){for(var e={},s=0;s<t.documentList.length;s++)t.documentList[s].id===a&&(e=t.documentList[s],t.documentList.splice(s,1));var n,l=Object(Ka["a"])(t.tagList);try{for(l.s();!(n=l.n()).done;){var p=n.value;if(-1!==e.tagList.indexOf(p.name)){var r=p.documentIdList.indexOf(a);p.documentIdList.splice(r,1)}}}catch(d){l.e(d)}finally{l.f()}J.saveFile("data.json",JSON.stringify(t))}))},editDocumentInfo:function(a){W.queryData().then((function(t){for(var e={},s=0;s<t.documentList.length;s++){var n=t.documentList[s];if(n.id===a.id){e=n,t.documentList.splice(s,1),t.documentList.push(a);break}}var l,p=Object(Ka["a"])(t.tagList);try{for(p.s();!(l=p.n()).done;){var r=l.value;if(-1!==e.tagList.indexOf(r.name)){var d=r.documentIdList.indexOf(a.id);r.documentIdList.splice(d,1)}}}catch(x){p.e(x)}finally{p.f()}var u,i=Object(Ka["a"])(t.tagList);try{for(i.s();!(u=i.n()).done;){var o=u.value,c=a.tagList.indexOf(o.name);-1!==c&&(o.documentIdList.push(a.id),a.tagList.splice(c,1))}}catch(x){i.e(x)}finally{i.f()}var g,f=Object(Ka["a"])(a.tagList);try{for(f.s();!(g=f.n()).done;){var m=g.value;t.tagList.push({name:m,documentIdList:[a.id]})}}catch(x){f.e(x)}finally{f.f()}J.saveFile("data.json",JSON.stringify(t))}))},addDocumentInfo:function(a){var t=this;W.queryData().then((function(e){e.tagList=t.tagDuplicateRemoval(e.tagList,a.tagList,a.id),e.documentList.push(a),J.saveFile("data.json",JSON.stringify(e))}))},tagDuplicateRemoval:function(a,t,e){if(a&&a.length>0){var s,n=Object(Ka["a"])(a);try{for(n.s();!(s=n.n()).done;){var l,p=s.value,r=Object(Ka["a"])(t);try{for(r.s();!(l=r.n()).done;){var d=l.value;p.name===d&&p.documentIdList.push(e)}}catch(m){r.e(m)}finally{r.f()}}}catch(m){n.e(m)}finally{n.f()}var u,i=Object(Ka["a"])(t);try{for(i.s();!(u=i.n()).done;){var o=u.value;a.push({name:o,documentIdList:[e]})}}catch(m){i.e(m)}finally{i.f()}}else{var c,g=Object(Ka["a"])(t);try{for(g.s();!(c=g.n()).done;){var f=c.value;a.push({name:f,documentIdList:[e]})}}catch(m){g.e(m)}finally{g.f()}}return a}}),Va=Ua,Qa={name:"BackendDocumentList",data:function(){return{columns:J.documentListColumns(),documentList:[],pagination:{current:1,pageSize:5,total:0,type:1},rowSelection:{onChange:function(a,t){console.log("selectedRowKeys: ".concat(a),"selectedRows: ",t)},onSelect:function(a,t,e){console.log(a,t,e)},onSelectAll:function(a,t,e){console.log(a,t,e)}},expandedRowKeys:[]}},mounted:function(){this.paginationHandler(this.pagination)},methods:{paginationHandler:function(a){var t=this;W.getDocumentList({page:a.current,rows:a.pageSize,type:a.type}).then((function(e){t.documentList=e.data.list,t.pagination.total=e.data.total,t.pagination.current=a.current}))},timestamp:function(a){return J.timestamp(a)},changeDocumentStatusHandler:function(a,t){var e,s=Object(Ka["a"])(this.documentList);try{for(s.s();!(e=s.n()).done;){var n=e.value;if(n.id===a){n.status="1"===t;break}}}catch(l){s.e(l)}finally{s.f()}},saveEditDocumenthandler:function(){Va.saveEditData(this.documentList),this.paginationHandler({current:1,pageSize:5,total:0,type:1})},editDocumentHander:function(a){this.$message.info("编辑文档"),console.log(a)},starDocumentHandler:function(a,t){var e,s=Object(Ka["a"])(this.documentList);try{for(s.s();!(e=s.n()).done;){var n=e.value;if(n.id===a){n.label=t;break}}}catch(l){s.e(l)}finally{s.f()}},deleteDocumentHandler:function(a){console.log(a)}},components:{BackendTitleBar:qa}},Ga=Qa,Za=(e("5cb7"),Object(d["a"])(Ga,Fa,Ja,!1,null,"07b36535",null)),Ya=Za.exports,Xa=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("backend-title-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("添加文章")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action1",type:"primary"},slot:"action1"},[e("a-icon",{attrs:{type:"save"}}),a._v(" "),e("span",[a._v("保存")])],1),e("div",{attrs:{slot:"action2"},slot:"action2"},[e("a-tooltip",{attrs:{placement:"left"}},[e("div",{attrs:{slot:"title"},slot:"title"},[0===a.documentList.length?e("span",[a._v("你还没有添加文章, 快去试试创建一篇文章吧")]):a._e(),a.documentList.length>0?e("div",[e("div",{staticClass:"save-document-list"},a._l(a.documentList,(function(t,s){return e("div",{key:s},[e("span",{staticClass:"prefix"},[a._v(a._s(s+1))]),e("span",{staticClass:"text"},[a._v(a._s(t.title))]),e("span",{staticClass:"suffix",on:{click:function(t){return a.deleteDocumentListHandler(s)}}},[e("a-icon",{attrs:{type:"delete"}})],1)])})),0)]):a._e()]),e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:a.saveDocumentListHandler}},[e("a-icon",{attrs:{type:"export"}}),a._v(" "),e("span",[a._v("导出("+a._s(a.documentList.length)+")")])],1)],1)],1)],1),e("div",{staticClass:"document-add-steps-box"},[e("a-steps",{attrs:{current:a.tabsActiveKey}},[e("a-step",{attrs:{title:"创建文章基本信息"}}),e("a-step",{attrs:{title:"创建文章正文信息"}}),e("a-step",{attrs:{title:"预览文章信息"}})],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:0===a.tabsActiveKey,expression:"tabsActiveKey === 0"}]},[e("div",{staticClass:"document-add-body-box"},[e("div",{staticClass:"document-add-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("文章ID：")])]),e("a-col",{attrs:{span:22}},[e("div",{staticClass:"document-add-body-item-input"},[a._v(a._s(a.documentInfo.id))])])],1)],1),e("div",{staticClass:"document-add-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("文章标题：")])]),e("a-col",{attrs:{span:22}},[e("a-input",{attrs:{size:"large"},model:{value:a.documentInfo.title,callback:function(t){a.$set(a.documentInfo,"title",t)},expression:"documentInfo.title"}})],1)],1)],1),e("div",{staticClass:"document-add-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("文章标签：")])]),e("a-col",{attrs:{span:10}},[e("a-select",{staticStyle:{width:"100%"},attrs:{mode:"tags",size:"large",defaultValue:[],placeholder:"选择文章标签"},on:{change:a.handleChange},model:{value:a.documentInfo.tagList,callback:function(t){a.$set(a.documentInfo,"tagList",t)},expression:"documentInfo.tagList"}},a._l(a.tagList,(function(t){return e("a-select-option",{key:t.name},[a._v(" "+a._s(t.name)+" ")])})),1)],1),e("a-col",{attrs:{span:3}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("创建时间：")])]),e("a-col",{attrs:{span:9}},[e("div",{staticClass:"document-add-body-item-input"},[a._v(a._s(a.timestamp(a.documentInfo.datetime)))])])],1)],1),e("div",{staticClass:"document-add-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("阅读：")])]),e("a-col",{attrs:{span:6}},[e("a-input",{attrs:{size:"large"},model:{value:a.documentInfo.action.read,callback:function(t){a.$set(a.documentInfo.action,"read",t)},expression:"documentInfo.action.read"}})],1),e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("点赞：")])]),e("a-col",{attrs:{span:6}},[e("a-input",{attrs:{size:"large"},model:{value:a.documentInfo.action.like,callback:function(t){a.$set(a.documentInfo.action,"like",t)},expression:"documentInfo.action.like"}})],1),e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("评论：")])]),e("a-col",{attrs:{span:6}},[e("div",{staticClass:"document-add-body-item-input"},[a._v(a._s(a.documentInfo.action.comment))])])],1)],1),e("div",{staticClass:"document-add-body-item"},[e("a-row",[e("a-col",{attrs:{span:2}},[e("div",{staticClass:"document-add-body-item-title"},[a._v("封面：")])]),e("a-col",{attrs:{span:8}},[e("a-input",{attrs:{size:"large"},on:{blur:a.addDocumentImgHandler},model:{value:a.documentImg,callback:function(t){a.documentImg=t},expression:"documentImg"}})],1),e("a-col",{attrs:{span:13,offset:1}},[e("div",{staticClass:"document-img-box"},[e("div",{directives:[{name:"show",rawName:"v-show",value:""!==a.documentInfo.img,expression:"documentInfo.img !== ''"}],staticClass:"document-img-info"},[e("img",{attrs:{src:a.documentInfo.img,alt:""}}),e("div",{staticClass:"document-img-text"},[e("a-icon",{attrs:{type:"delete"},on:{click:a.deleteDocumentImgHandler}})],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:""===a.documentInfo.img,expression:"documentInfo.img === ''"}],staticClass:"document-img-x-info"},[e("a-icon",{attrs:{type:"interaction"}})],1)])])],1)],1),e("div",{staticClass:"document-add-body-next-btn-box"},[e("a-row",[e("a-col",{attrs:{span:3,offset:21}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:function(t){return a.nextDocumentHandler(1)}}},[a._v("创建文章正文")])],1)],1)],1)])]),e("div",{directives:[{name:"show",rawName:"v-show",value:1===a.tabsActiveKey,expression:"tabsActiveKey === 1"}]},[e("div",{staticClass:"document-add-body-editor-box"},[a._m(0),e("div",{staticClass:"document-add-body-next-btn-box"},[e("a-row",[e("a-col",{attrs:{span:3}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:function(t){return a.nextDocumentHandler(0)}}},[a._v("返回上一步")])],1),e("a-col",{attrs:{span:3,offset:14}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:function(t){return a.nextDocumentHandler(2)}}},[a._v("预览文章")])],1),e("a-col",{attrs:{span:3,offset:1}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:a.saveDocumentInfoHandler}},[a._v("添加文章")])],1)],1)],1)])]),e("div",{directives:[{name:"show",rawName:"v-show",value:2===a.tabsActiveKey,expression:"tabsActiveKey === 2"}]},[e("div",{staticClass:"document-add-body-editor-box"},[e("div",{staticClass:"preview-box"},[e("div",{staticClass:"title"},[a._v("# "+a._s(a.documentInfo.title))]),e("div",{directives:[{name:"highlight",rawName:"v-highlight"}],domProps:{innerHTML:a._s(a.documentInfo.content)}})]),e("div",{staticClass:"document-add-body-next-btn-box"},[e("a-row",[e("a-col",{attrs:{span:3}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:function(t){return a.nextDocumentHandler(1)}}},[a._v("返回上一步")])],1),e("a-col",{attrs:{span:3,offset:18}},[e("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",size:"large"},on:{click:a.saveDocumentInfoHandler}},[a._v("添加文章")])],1)],1)],1)])])],1)},at=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"full-screen-container"},[e("div",{attrs:{id:"toolbar-container"}}),e("div",{attrs:{id:"editor-container"}})])}],tt=(e("6e2e"),e("1487")),et=e.n(tt),st=[],nt={addDocumentList:function(a){var t,e=Object(Ka["a"])(a);try{for(e.s();!(t=e.n()).done;){var s=t.value;st.push(s)}}catch(n){e.e(n)}finally{e.f()}sessionStorage.setItem("luochen-document-list",JSON.stringify(st))},getDocumentList:function(){return st.length<1&&(st=JSON.parse(sessionStorage.getItem("luochen-document-list"))),st},cleanDocumentList:function(){st=[],sessionStorage.removeItem("luochen-document-list")}},lt=nt,pt=window.wangEditor,rt=pt.createEditor,dt=pt.createToolbar,ut=void 0,it={name:"BackendAddDocument",data:function(){return{tabsActiveKey:0,documentList:[],tagList:[],documentImg:"",documentInfo:{id:J.getuuid(),title:"",img:"",status:!0,label:"",tagList:[],tag:"",abstract:"",action:{read:Math.ceil(1e4*Math.random()+200),like:Math.ceil(1e4*Math.random()+200),comment:0},datetime:(new Date).getTime(),catalogue:[],content:""}}},mounted:function(){var a=this;W.getTagList({page:1,rows:10}).then((function(t){2e3===t.code&&(a.tagList=t.data)})),this.createEditor()},methods:{createEditor:function(){var a={};ut=rt({selector:"#editor-container",config:a,mode:"default"}),ut.highlight=et.a;var t={};dt({editor:ut,selector:"#toolbar-container",config:t,mode:"default"})},timestamp:function(a){return J.timestamp(a)},handleChange:function(){this.documentInfo.tagList.length>3&&(this.$message.warning("文件标签最多只能选择3个"),this.documentInfo.tagList.splice(3,1))},nextDocumentHandler:function(a){if(1===a){if(this.documentInfo.title.length<1)return void this.$message.warning("文章标题为必填项");if(this.documentInfo.img.length<1)return void this.$message.warning("文章封面为必填项")}this.tabsActiveKey=a,this.saveDocumentInfoHandler(!1)},addDocumentImgHandler:function(){this.documentInfo.img=this.documentImg},deleteDocumentListHandler:function(a){this.documentList.splice(a,1)},deleteDocumentImgHandler:function(){this.documentInfo.img="",this.documentImg=""},saveDocumentListHandler:function(){0===this.documentList.length?this.$message.warning("未添加文章信息, 无法保存"):Va.saveDataToFile(this.documentList)},saveDocumentInfoHandler:function(a){ut?(this.documentInfo.catalogue=ut.getElemsByTypePrefix("header"),this.documentInfo.abstract=ut.getText(),this.documentInfo.content=$(".w-e-scroll").html(),a&&(this.documentList.push(JSON.parse(JSON.stringify(this.documentInfo))),lt.addDocumentList(this.documentList),this.documentInfo={id:J.getuuid(),title:"",img:"",tagList:[],abstract:"",tag:"",action:{read:Math.ceil(1e4*Math.random()+200),like:Math.ceil(1e4*Math.random()+200),comment:0},datetime:(new Date).getTime(),catalogue:[],content:""},ut.clear(),this.documentImg="",this.tabsActiveKey=0)):this.$message.error("创建富文本编辑器失败")}},components:{BackendTitleBar:qa}},ot=it,ct=(e("1ba1"),Object(d["a"])(ot,Xa,at,!1,null,"957752be",null)),gt=ct.exports,ft=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("backend-title-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("添加导航")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action1",type:"primary",icon:"save"},slot:"action1"},[a._v("保存")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action2",type:"primary",icon:"export"},slot:"action2"},[a._v("导出")])],1),e("h1",[a._v("add")])],1)},mt=[],xt={name:"BackNavigationAdd",components:{BackendTitleBar:qa}},kt=xt,wt=Object(d["a"])(kt,ft,mt,!1,null,"660fead6",null),ht=wt.exports,yt=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("backend-title-bar",[e("span",{attrs:{slot:"title"},slot:"title"},[a._v("导航列表")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action1",type:"primary",icon:"save"},slot:"action1"},[a._v("保存")]),e("a-button",{staticStyle:{width:"100%"},attrs:{slot:"action2",type:"primary",icon:"export"},slot:"action2"},[a._v("导出")])],1),e("div",{staticClass:"nav-card-box"},[e("a-row",a._l(4,(function(t){return e("a-col",{key:t,attrs:{span:6}},[e("div",{staticClass:"nav-card-item-box"},[e("div",{staticClass:"nav-card-item"},[e("a-row",[e("a-col",{attrs:{span:20}},[e("div",{staticClass:"nav-card-item-title"},[a._v("总导航数")]),e("div",{staticClass:"nav-card-item-num"},[a._v("32134")])]),e("a-col",{attrs:{span:4}},[e("div",{staticClass:"nav-card-item-icon"},[e("a-icon",{attrs:{type:"file-sync"}})],1)])],1)],1)])])})),1)],1),e("div",{staticClass:"nav-list-box"},[e("a-table",{attrs:{columns:a.columns,"data-source":a.navList},scopedSlots:a._u([{key:"groupNum",fn:function(t,s){return e("span",{},[a._v(" "+a._s(s.list.length)+" ")])}},{key:"expandedRowRender",fn:function(t,s){return e("a-table",{attrs:{columns:a.subColumns,"data-source":s.list},scopedSlots:a._u([{key:"img",fn:function(a){return e("div",{staticClass:"nav-list-img"},[e("img",{attrs:{src:a,alt:""}})])}}])})}}])})],1)],1)},bt=[],St={name:"BackNavigationList",data:function(){return{columns:J.navListColumns(),subColumns:J.navListSubColumns(),navList:[{group:"xxxxx",list:[{name:"百度",link:"http://www.baidu.com",img:"https://d-image.i4.cn/image/icon/2022/07/11/12/382201985/z1657512961934_650957.jpg"}]}]}},components:{BackendTitleBar:qa}},vt=St,zt=(e("811b"),Object(d["a"])(vt,yt,bt,!1,null,"79ccf077",null)),At=zt.exports;s["a"].use(o["a"]);var _t=new o["a"]({routes:[{path:"/",name:"IndexView",component:k,meta:{auth:!1},children:[{path:"/",name:"IndexMain",component:X,meta:{auth:!1}},{path:"/document/:id",name:"DocumentMain",component:ga,meta:{auth:!1}}]},{path:"/backend/login",name:"BackendLogin",component:Aa,children:[]},{path:"/backend",name:"BackendIndex",component:ha,children:[{path:"/",name:"BackendMain",component:Pa},{path:"/backend/document",name:"BackendDocument",component:$a},{path:"/backend/document/list",name:"BackendDocumentList",component:Ya},{path:"/backend/document/add",name:"BackendAddDocument",component:gt},{path:"/backend/navigation/add",name:"BackNavigationAdd",component:ht},{path:"/backend/navigation/list",name:"BackNavigationList",component:At}]}]});_t.beforeEach((function(a,t,e){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.pageYOffset=0,e()}));var Ct=_t,Lt=e("f23d");e("202f");s["a"].use(Lt["a"]),s["a"].config.productionTip=!1,e("5313"),s["a"].directive("highlight",(function(a){var t=a.querySelectorAll("pre code");t.forEach((function(a){et.a.highlightBlock(a)}))})),s["a"].prototype.$hljs=et.a,new s["a"]({router:Ct,render:function(a){return a(i)}}).$mount("#app")},"5c35":function(a,t,e){},"5cb7":function(a,t,e){"use strict";e("cd98")},"5ffc":function(a,t,e){"use strict";e("8de1")},6238:function(a,t,e){"use strict";e("3097")},6728:function(a,t,e){},"7a6f":function(a,t,e){"use strict";e("9765")},"811b":function(a,t,e){"use strict";e("0efe")},"85ec":function(a,t,e){},"8de1":function(a,t,e){},9765:function(a,t,e){},"9c39":function(a,t,e){"use strict";e("de54")},"9d10":function(a,t,e){"use strict";e("ed42")},a258:function(a,t,e){"use strict";e("6728")},a977:function(a,t,e){"use strict";e("5c35")},c635:function(a,t,e){"use strict";e("3039")},cd53:function(a,t,e){},cd98:function(a,t,e){},de54:function(a,t,e){},ed42:function(a,t,e){},f452:function(a,t,e){}});
//# sourceMappingURL=app.37368ec4.js.map